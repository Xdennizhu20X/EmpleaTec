<div class="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 font-sans text-gray-800">
  <!-- Header -->
  <header class="sticky top-0 z-10 bg-white/50 backdrop-blur-lg">
    <div class="flex h-20 items-center justify-between px-4 sm:px-8">
      <button (click)="onBack()" class="flex items-center gap-2 rounded-full p-2 text-gray-600 transition-colors duration-200 hover:bg-gray-200/50 hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
      </button>
      <div class="flex items-center gap-3">
        <h1 class="text-xl font-bold text-blue-900">Mensajes</h1>
        <span *ngIf="totalUnreadMessages() > 0" class="flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-xs font-bold text-white">{{ totalUnreadMessages() }}</span>
      </div>
      <button class="p-2">
      </button>
    </div>
  </header>

  <!-- Page Content -->
  <main class="container mx-auto max-w-4xl p-4 sm:p-8">
    <!-- Search Bar -->
    <div class="relative mb-8">
      <input type="text" [ngModel]="searchQuery()" (ngModelChange)="searchQuery.set($event)" placeholder="Buscar por nombre o proyecto..." class="w-full rounded-full border-2 border-white/80 bg-white/50 py-3 pl-12 pr-4 text-lg text-blue-900 shadow-sm backdrop-blur-lg placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500">
      <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
    </div>

    <!-- Chats List -->
    <div class="space-y-4">
      <div *ngIf="filteredChats().length === 0" class="text-center py-16">
        <h3 class="text-lg font-semibold text-blue-800">No hay conversaciones</h3>
        <p class="text-gray-600">{{ searchQuery() ? 'No se encontraron conversaciones' : 'AÃºn no tienes chats.' }}</p>
      </div>

      <div *ngFor="let chat of filteredChats()" (click)="handleChatClick(chat)" class="cursor-pointer rounded-2xl bg-white/50 p-4 shadow-md backdrop-blur-lg transition-all duration-300 hover:scale-[1.02] hover:bg-white/70">
        <div class="flex items-center space-x-4">
          <div class="relative flex-shrink-0">
            <img [src]="getParticipant(chat)?.avatar" [alt]="getParticipant(chat)?.name" class="h-14 w-14 rounded-full">
            <span *ngIf="getParticipant(chat)?.isOnline" class="absolute -bottom-0.5 -right-0.5 h-4 w-4 rounded-full border-2 border-white bg-green-500"></span>
          </div>
          <div class="min-w-0 flex-1">
            <div class="flex justify-between">
              <h4 class="truncate font-bold text-blue-900">{{ getParticipant(chat)?.name }}</h4>
              <span class="text-xs text-gray-500">{{ formatTimeAgo(chat.lastMessage.timestamp) }}</span>
            </div>
            <p class="truncate text-sm font-medium text-gray-600">{{ chat.projectTitle }}</p>
            <div class="flex justify-between items-end mt-1">
              <p class="truncate text-sm text-gray-500" [class.font-bold]="chat.unreadCount > 0" [class.text-blue-800]="chat.unreadCount > 0">
                {{ chat.lastMessage.text }}
              </p>
              <span *ngIf="chat.unreadCount > 0" class="flex h-5 min-w-[20px] items-center justify-center rounded-full bg-blue-500 px-2 text-xs font-bold text-white">
                {{ chat.unreadCount }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
''
