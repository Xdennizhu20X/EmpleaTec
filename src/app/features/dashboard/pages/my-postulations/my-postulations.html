<div class="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 font-sans text-gray-800">
  <!-- Header -->
  <header class="sticky top-0 z-20 bg-white/50 backdrop-blur-lg">
    <div class="container mx-auto flex h-16 items-center justify-between px-4 sm:px-6">
      <a routerLink="/dashboard-worker" class="flex items-center gap-2 rounded-full p-2 text-gray-600 transition-colors duration-200 hover:bg-gray-200/50 hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
      </a>
      <h1 class="text-xl font-bold text-blue-900">Mis Postulaciones</h1>
      <div class="w-6"></div> <!-- Spacer for balance -->
    </div>
  </header>

  <!-- Page Content -->
  <main class="container mx-auto max-w-4xl p-4 sm:p-6">
    @if (postulations$ | async; as postulations) {
      <div>
        @if (postulations.length > 0) {
          <div>
            <div class="space-y-6">
              @for (postulation of postulations; track postulation) {
                <div class="rounded-2xl bg-white/50 p-6 shadow-md backdrop-blur-lg transition-all duration-300 hover:bg-white/70">
                  <div class="flex flex-col sm:flex-row gap-6">
                    <img [src]="postulation.jobData.images[0] || 'https://via.placeholder.com/150'" alt="Job image"
                      class="h-32 w-full sm:w-48 rounded-lg object-cover flex-shrink-0">
                      <div class="flex-grow">
                        <div class="flex justify-between items-start">
                          <h4 class="text-lg font-bold text-blue-900">{{ postulation.jobData.title }}</h4>
                          <span class="text-lg font-bold text-blue-700">
                            ${{ postulation.jobData.budget.min | number }} - ${{ postulation.jobData.budget.max | number }}
                          </span>
                        </div>
                        <div class="mt-2 flex items-center gap-2">
                          <span class="px-3 py-1 rounded-full text-sm font-medium {{ getStatusClass(postulation.status) }}">
                            {{ postulation.status === 'accepted' ? 'Aceptado' :
                            postulation.status === 'rejected' ? 'Rechazado' : 'Pendiente' }}
                          </span>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">Publicado por: {{ postulation.jobData.clientName }}</p>
                        <p class="text-sm text-gray-600 mt-2 line-clamp-2">{{ postulation.jobData.description }}</p>
                        <div class="mt-4">
                          <h5 class="font-medium text-blue-900 mb-1">Mi mensaje de postulación:</h5>
                          <p class="text-sm text-gray-700 bg-gray-100/50 p-3 rounded-lg">{{ postulation.description }}</p>
                        </div>
                        <div class="mt-4 flex flex-wrap gap-x-4 gap-y-2 text-sm text-gray-700">
                          <span class="flex items-center gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            {{ postulation.jobData.location }}
                          </span>
                          <span class="flex items-center gap-1.5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            Inicia: {{ postulation.jobData.timeline.start | date:'mediumDate' }}
                          </span>
                          @if (postulation.jobData.timeline.end) {
                            <span class="flex items-center gap-1.5">
                              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                              </svg>
                              Termina: {{ postulation.jobData.timeline.end | date:'mediumDate' }}
                            </span>
                          }
                        </div>
                        <a [routerLink]="['/job-detail', postulation.jobId]"
                          class="mt-4 inline-block px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                          Ver detalles del trabajo
                        </a>
                      </div>
                    </div>
                  </div>
                }
              </div>
            </div>
          } @else {
            <div class="text-center py-16">
              <h3 class="text-lg font-semibold text-blue-800">No has postulado a ningún trabajo aún</h3>
              <p class="text-gray-600">Cuando postules a trabajos, aparecerán aquí con su estado actual.</p>
              <a routerLink="/jobs-explorer" class="mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                Explorar trabajos disponibles
              </a>
            </div>
          }
        </div>
      } @else {
        <div class="text-center py-16">
          <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-4"></div>
          <p class="text-gray-600">Cargando tus postulaciones...</p>
        </div>
      }

    </main>
  </div>